#%RAML 0.8
title: sharkScan api
baseUri: http://localhost/api/{version}
version: v1.0
mediaType: application/json

/Scan:
  get:
    description: get all the scans saved showing name and stats
    queryParameters:
      name:
        description: name of the saved scan
      date:
        description: date of the saved scan
        type: datetime
  /{name}:
    description: get the specific scan info
    uriParameters:
      name:
        description: the name of the scan
    responses:
      200:
        body:
          example: |
          { 
          "hosts" : 
          [
          {
            "address" : "76.220.45.101", 
            "tcp_ports" : [ "445" ] 
          }, 
          { 
            "address" : "76.220.52.101",
            "tcp_ports" : [ "445" ] 
          }
          ],
            "stats" :
          {
            "start_time" : "1496328029",
            "finish_time" : "1496333089",
            "elapsed" : "5060.10",
            "summary" : "Nmap done at Thu Jun  1 13:04:49 2017; 131072 IP addresses (131072 hosts up) scanned in 5060.10 seconds",
            "exit" : "success"
          },
          "name" : "scan.of.my.network"
          }
      201:
        description: The scan was found but not completed yet
      404:
        description: The scan was not found

  post:
    description: Post a new scan request
    body:
      example: |
      {
        "name": "scan.of.my.network",
        "type": "nmap-os",
        "args": "--script smb-os-discovery"
        "target": "192.168.0.0/16"
      }
      responses:
        202:
          description: The request has been made

/hostInScan:
  get:
    description: Show info about one host(by address) in a particular scan
    queryParameters:
      name:
        description: Name of the scan
      address:
        description: IP address of the host
    responses:
      200:
        description: Host found on the scan
        body:
          sample: |
          {
            "address": "192.168.1.1",
            "hostname": "testserver"
            "tcp_ports": [22,3389],
            "udp_ports": [53,161],
            "os_matchs": [
              {
                "name":"MS 7 SP1",
                "accuracy":"99",
                "class":"general propouse",
                "vendor":"Microsoft",
                "family":"Windows",
                "version":"7",
                "cpe":"cpe:/o:microsoft:windows_server_2008"
              }
            ]
          }
      404:
        description: The host was not found on the scan
      412:
        description: The scan was not found